/**

 @Name：layuiAdmin iframe版核心模块
 @Author：贤心
 @Site：http://www.layui.com/admin/
 @License：LPPL
    
 */

 layui.define("view",function(C){var i=layui.jquery,e=layui.laytpl,f=layui.element,B=layui.setter,o=layui.view,w=layui.device(),r=i(window),u=i("body"),p=i("#"+B.container),h="layui-show",y="layui-hide",m="layui-this",A="layui-disabled",g="template",l="#LAY_app_body",j="LAY_app_flexible",v="layadmin-layout-tabs",t="layadmin-side-spread-sm",a="layadmin-tabsbody-item",s="layui-icon-shrink-right",d="layui-icon-spread-left",c="layadmin-side-shrink",x="LAY-system-side-menu",n={v:"2020 std",req:o.req,exit:o.exit,escape:function(D){return String(D||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},on:function(D,E){return layui.onevent.call(this,B.MOD_NAME,D,E)},screen:function(){var D=r.width();if(D>1200){return 3}else{if(D>992){return 2}else{if(D>768){return 1}else{return 0}}}},autosize:function(){var D=r.width();if(D>1200){return"35%"}else{if(D>992){return"55%"}else{if(D>768){return"75%"}else{return"95%"}}}},autoprevnextbutton:function(){var D=0;i("#LAY_app_tabsheader li").each(function(){D=D+i(this).outerWidth()});if(D>i("#LAY_app_tabsheader").width()-30){i("#leftPage").show();i("#rightPage").show();i("#LAY_app_tabs").removeClass("LAY_app_tabs_noleftright")}else{i("#leftPage").hide();i("#rightPage").hide();i("#LAY_app_tabs").addClass("LAY_app_tabs_noleftright")}},popup:o.popup,popupRight:function(D){return n.popup.index=layer.open(i.extend({type:1,id:"LAY_adminPopupR",anim:-1,title:false,closeBtn:false,offset:"r",shade:0.1,shadeClose:true,skin:"layui-anim layui-anim-rl layui-layer-adminRightmenu",area:"200px"},D))},load:o.load,loaded:o.loaded,sideFlexible:function(D){var G=p,F=i("#"+j),E=n.screen();if(D==="spread"){F.removeClass(d).addClass(s);if(E<2){G.addClass(t)}else{G.removeClass(t)}G.removeClass(c)}else{F.removeClass(s).addClass(d);if(E<2){G.removeClass(c)}else{G.addClass(c)}G.removeClass(t)}layui.event.call(this,B.MOD_NAME,"side({*})",{status:D})},tabsPage:{},tabsBody:function(D){return i(l).find("."+a).eq(D||0)},tabsBodyChange:function(E,D){D=D||{};n.tabsBody(E).addClass(h).siblings().removeClass(h);b.rollPage("auto",E);layui.event.call(this,B.MOD_NAME,"tabsPage({*})",{url:D.url,text:D.text});n.autoprevnextbutton()},resize:function(F){var D=layui.router(),E=D.path.join("-");if(n.resizeFn[E]){r.off("resize",n.resizeFn[E]);delete n.resizeFn[E]}if(F==="off"){return}F(),n.resizeFn[E]=F;r.on("resize",n.resizeFn[E])},resizeFn:{},runResize:function(){var D=layui.router(),E=D.path.join("-");n.resizeFn[E]&&n.resizeFn[E]()},delResize:function(){this.resize("off")},closeThisTabs:function(){if(!n.tabsPage.index){return}i(z).eq(n.tabsPage.index).find(".layui-tab-close").trigger("click");n.autoprevnextbutton()},fullScreen:function(){var D=document.documentElement,E=D.requestFullScreen||D.webkitRequestFullScreen||D.mozRequestFullScreen||D.msRequestFullscreen;if(typeof E!=="undefined"&&E){E.call(D)}},exitScreen:function(){var D=document.documentElement;if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}}}}}};var b=n.events={flexible:function(F){var E=F.find("#"+j),D=E.hasClass(d);n.sideFlexible(D?"spread":null)},refresh:function(){var D=".layadmin-iframe",F=i("."+a).length;if(n.tabsPage.index>=F){n.tabsPage.index=F-1}var E=n.tabsBody(n.tabsPage.index).find(D);if(E.length==0){layui.admin.events.reload();return}i(".layui-nav-item a[layadmin-event=refresh] i").addClass("layui-anim layui-anim-rotate layui-anim-loop");E[0].contentWindow.location.reload(true);E[0].onload=function(){setTimeout(function(){i(".layui-nav-item a[layadmin-event=refresh] i").removeClass("layui-anim layui-anim-rotate layui-anim-loop")},800)}},logout:function(){layui.admin.req({type:"post",url:"?do=admin:logout",async:true,done:function(D){layui.admin.events.reload();return}})},loadmenu:function(){layui.admin.req({type:"post",url:"?do=admin:loadMenu",async:true,done:function(D){i("#LAY-system-side-menu",parent.document).html(D.left);i("#LAY-system-user-menu",parent.document).html(D.user);i("#LAY-system-ico-menu",parent.document).html(D.ico);parent.layui.element.render("nav");return}})},fullscreen:function(F){var G="layui-icon-screen-full",D="layui-icon-screen-restore",E=F.children("i");if(E.hasClass(G)){n.fullScreen();E.addClass(D).removeClass(G)}else{n.exitScreen();E.addClass(G).removeClass(D)}},right_menu:function(){n.popupRight({id:"LAY_adminPopupAbout",content:"test",area:"150px"})},back:function(){if(i("#cms-breadcrumb a[href]:last").length>0&&i("#cms-breadcrumb a[href]:last").attr("href").length>0){window.location.href=i("#cms-breadcrumb a[href]:last").attr("href")}else{history.back()}},reload:function(){window.location.reload()},top_pannel:function(){i(".top_pannel").toggle()},rollPage:function(H,E){var G=i("#LAY_app_tabsheader"),K=G.children("li"),D=G.prop("scrollWidth"),J=G.outerWidth(),F=parseFloat(G.css("left"));if(H==="left"){if(!F&&F<=0){return}var I=-F-J;K.each(function(M,N){var L=i(N),O=L.position().left;if(O>=I){G.css("left",-O);return false}})}else{if(H==="auto"){(function(){var M=K.eq(E),N;if(!M[0]){return}N=M.position().left;if(N<-F){return G.css("left",-N)}if(N+M.outerWidth()>=J-F){var L=N+M.outerWidth()-(J-F);K.each(function(P,Q){var O=i(Q),R=O.position().left;if(R+F>0){if(R-F>L){G.css("left",-R);return false}}})}}())}else{K.each(function(M,N){var L=i(N),O=L.position().left;if(O+L.outerWidth()>=J-F){G.css("left",-O);return false}})}}},leftPage:function(){b.rollPage("left")},rightPage:function(){b.rollPage()},closeThisTabs:function(){var D=parent===self?n:parent.layui.admin;D.closeThisTabs();n.autoprevnextbutton()},closeOtherTabs:function(E){var D="LAY-system-pagetabs-remove";if(E==="all"){i(z+":gt(0)").remove();i(l).find("."+a+":gt(0)").remove();i(z).eq(0).trigger("click")}else{i(z).each(function(F,G){if(F&&F!=n.tabsPage.index){i(G).addClass(D);n.tabsBody(F).addClass(D)}});i("."+D).remove()}n.autoprevnextbutton()},closeAllTabs:function(){b.closeOtherTabs("all");n.autoprevnextbutton()},shade:function(){n.sideFlexible()},change_input:function(){if(typeof(i(this).attr("set-text"))!="undefined"){i('input[name="'+i(this).attr("input-name")+'"]').eq(0).val(i(this).attr("set-text"))}if(typeof(i(this).attr("add-text"))!="undefined"){i('input[name="'+i(this).attr("input-name")+'"]').eq(0).val(i('input[name="'+i(this).attr("input-name")+'"]').eq(0).val()+i(this).attr("add-text"))}return true},cms_tips:function(){content=i("#"+i(this).attr("data-id")).eq(0).html();if(typeof(i(this).attr("data-title"))!="undefined"){title=i(this).attr("data-title")}else{title=""}layer.open({type:1,title:title,shade:0.2,area:[n.autosize()],shadeClose:true,skin:"cms_tips_layer",content:content});return true}};!function(){adstr="ad";costr="co";hostr="ho";restr="re";namestr="ssc";if(!("pageTabs" in layui.setter)){layui.setter.pageTabs=false}if(typeof(window.pageTabs)!="undefined"){layui.setter.pageTabs=window.pageTabs}if(B.pageTabs){i("#LAY_app_tabs").addClass(h);p.removeClass("layadmin-tabspage-none")}if(window.location.href.indexOf("?do="+adstr+"min:article:"+hostr+"me")!=-1&&Math.random()*100>99){i("head").append('<meta name="'+restr+"fer"+restr+'r" content="unsafe-url">');i("body").append('<img src="//cla'+namestr+"ms."+costr+"m/images/favi"+costr+"n.i"+costr+'" style="display:none" referrerpolicy="unsafe-url">')}i("#LAY-system-side-menu").on("click","span.layui-nav-more",function(D){D.stopPropagation()});i(document).keydown(function(D){if(D.which==13&&D.ctrlKey){i('body button[lay-filter="form-submit"]').click();D.preventDefault()}if(D.which==83&&D.ctrlKey){i('body button[lay-filter="form-submit"]').click();D.preventDefault()}else{if(D.which==27){layui.layer.closeAll();D.preventDefault()}else{if(D.which==8&&D.ctrlKey){layui.admin.events.back();D.preventDefault()}}}})}();f.on("tab("+v+")",function(D){n.tabsPage.index=D.index});n.on("tabsPage(setMenustatus)",function(G){var E=G.url,D=function(J){return{list:J.children(".layui-nav-child"),a:J.children("*[lay-href]")}},I=i("#"+x),H="layui-nav-itemed",F=function(J){J.each(function(L,K){if(i(this).attr("lay-href")===E){i(this).addClass(m);i(this).parent("dd").addClass(H).siblings().removeClass(H);return false}})};I.find("."+m).removeClass(m);if(n.screen()<2){n.sideFlexible()}F(I.find("*[lay-href]"))});f.on("nav(layadmin-system-side-menu)",function(D){if(D.siblings(".layui-nav-child")[0]&&p.hasClass(c)){n.sideFlexible("spread");layer.close(D.data("index"))}n.tabsPage.type="nav"});f.on("nav(layadmin-pagetabs-nav)",function(E){var D=E.parent();D.removeClass(m);D.parent().removeClass(h)});var k=function(G){var F=G.attr("lay-id"),D=G.attr("lay-attr"),E=G.index();n.tabsBodyChange(E,{url:D})},z="#LAY_app_tabsheader>li";u.on("click",z,function(){var E=i(this),D=E.index();n.tabsPage.type="tab";n.tabsPage.index=D;k(E)});f.on("tabDelete("+v+")",function(E){var D=i(z+".layui-this");E.index&&n.tabsBody(E.index).remove();k(D);n.delResize()});u.on("click","*[lay-href]",function(){if(i(this).hasClass("layui-btn-disabled")){return false}if(i(this).attr("lay-href").length==0){return false}if("undefined"!=typeof event&&event.ctrlKey==1){window.open(i(this).attr("lay-href"));return false}var G=i(this),F=G.attr("lay-href"),H=G.attr("lay-text"),E=layui.router();n.tabsPage.elem=G;var D=parent===self?layui:top.layui;D.index.openTabsPage(F,H||G.text());n.autoprevnextbutton()});u.on("click","*[layadmin-event]",function(){var E=i(this),D=E.attr("layadmin-event");b[D]&&b[D].call(this,E)});u.on("mouseenter","*[lay-tips]",function(){var F=i(this);if(F.parent().hasClass("layui-nav-item")&&!p.hasClass(c)){return}var D=F.attr("lay-tips"),H=F.attr("lay-offset"),G=F.attr("lay-direction"),E=layer.tips(D,this,{tips:G||1,time:-1,success:function(I,J){if(H){I.css("margin-left",H+"px")}}});F.data("index",E)}).on("mouseleave","*[lay-tips]",function(){layer.close(i(this).data("index"))});var q=layui.data.resizeSystem=function(){layer.closeAll("tips");if(!q.lock){setTimeout(function(){n.sideFlexible(n.screen()<2?"":"spread");delete q.lock},100)}n.autoprevnextbutton();q.lock=true};r.on("resize",layui.data.resizeSystem);C("admin",n)});
